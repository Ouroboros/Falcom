//====================================================================
//ステ`ジトラップスクリプト
//[12041][水没神殿－サブ①]
//====================================================================

#ScriptTable

//--------------------------------------------------------------------
//■グロ`バルフラグ
// 2928		フ`ドスロット
// Fx_241Food1 サブ① 

//■ル`トフラグ 2096-2192

// 2100 サブ② 中ボス死亡
// 2101 サブ③ 信号の色をBえた
// 2102 サブ③ _いたのは③扉
// 2103 サブ③ _いたのは④扉
// 2104 サブ③ _いたのは⑤扉
// 2105 サブ③ _いたのは⑥扉

// 2120 サブ① ①樽

// 2150 サブ① ①
// 2151 サブ① ②
// 2152 サブ① ③
// 2153 サブ① ④

// 2160 サブ② ①
// 2161 サブ② ②
// 2162 サブ② ③
// 2163 サブ② ④ハニワ

// 2170 サブ③ ①
// 2171 サブ③ ②
// 2172 サブ③ ③

//■ロ`カルフラグ
// 100 ①长出F
// 101 ③长出F
// 102 ⑤长出F

#TAKARA_CH	49
#IT_TAKARA	139		//◇139幸\の金

#WOODBOX_CH		48
#IT_WOODBOX		161		//∴161七草かゆ

//--------------------------------------------------------------------
INIT
{
//h境SE
	SE(71,0)

//■地形
	//壁から水①
	set_obj("mo20001a",	 4, 4,     0,   0,  0,  270)
	set_obj("mo20001a",	 9, 4,     0,   0,  0,    0)

	//床りマ`ク
    set_obj("mo20021a",	 7, 3,     0,   0,  1,    0)
    set_obj("mo20021a",	 4, 5,     0,   0,  1,  180)

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
//■A段．扉

	set_chr( 90,990,	10, 4,   100,   0,  0,		 90,  0102, 6,"K2_12010;")	//①エントリ 入口分岐
	set_obj("@ob20131a",10, 4,   100,   0,  0,		 90)						//①ア`チ（神殿）
	set_chr(190,1400,	10, 4,   100,   0,  0,		  0,    90, 0,";")			//ア`チ（ダミ`）

	set_chr( 91,990,	 1, 4,     0,   0,  0,		270,  0102, 6,"K0_0;")		//②エントリ サブ①
	set_chr(101,537,	 1, 4,     0,   0,  0,		  0,   270, 0,";")			//②A段上（神殿）
//?	set_obj("@ob20121a", 1, 4,     0,   0,  0,		270)						//②A段上（神殿）

	set_chr( 50,507,	 9, 4,   900,   0,  0,		  6,    90, 0,";")	//③扉（神殿） _放
	set_chr( 51,507,	 7, 4,   900,   0,  0,		  6,    90, 0,";")	//④扉（神殿） _放
	set_chr( 52,507,	 7, 4,  -900,   0,  0,		  6,   270, 0,";")	//⑤扉（神殿） _放
	set_chr( 53,507,	 4, 4,   900,   0,  0,		  6,    90, 0,";")	//⑥扉（神殿） _放
	set_chr( 54,507,	 4, 4,  -900,   0,  0,		  6,    90, 0,";")	//⑦扉（神殿） _放
	set_chr( 55,507,	 1, 4,   900,   0,  0,		  6,    90, 0,";")	//⑧扉（神殿） _放

//■スイッチ．看板

//■ハニワ．

	if ( !F2150 )
	{
		set_chr( 40,802,	 9, 4,  -900,   0,  0,		  2,     0, 0,"I_$$$1 SF2150 V4_140;")	//①
		set_chr(140,811,	 9, 4,  -900,   0,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(140,811,	 9, 4,  -900,   0,  0,		  0,     0, 0,";")
	}


	if ( !F2151 )
	{
		set_chr( 41,802,	 7, 4,     0,   0,  0,		  2,     0, 0,"I_$$$1 SF2151 V4_141;")	//②
		set_chr(141,811,	 7, 4,     0,   0,  0,		 -1,     0, 0,";")
	}
	else
	{
		set_chr(141,811,	 7, 4,     0,   0,  0,		  0,     0, 0,";")
	}


	if ( !F2152 )
	{
		set_chr( 11,137,	 6, 4,  -750,-100,  0,		  2,     0, 0,"D1_42 <EV_Show142>;")	//②a つぼみみっく

		set_chr( 42,802,	 6, 4,  -750,-100,  0,		  6,     0, 0,"SF2152;")	//③
		chr_equip_chr( 42,11, "charbase0", 100,	0,0,0,		0, 0,0);
		F_set_chr( 42, CF_NO_CSP)
		F_set_chr( 11, CF_NO_MINIMAP)

		set_chr(142,811,	 6, 4,  -750,-100,  0,		  0,     0, 8,"M2!11 <EV_ActiveteMimic11>;")
		chr_equip_chr(142,11, "charbase0", 100,	0,0,0,		0,0,0);
		color(142,-1);
	}
	else
	{
		set_chr(142,811,	 6, 4,  -750,-100,  0,		  0,     0, 0,";")
	}


	if ( !F2153 )
	{
		set_chr( 12,137,	 5, 4,   750,-100,  0,		  2,     0, 0,"D1_43 <EV_Show143>;")	//②b つぼみみっく

		set_chr( 43,802,	 5, 4,   750,-100,  0,		  6,     0, 0,"SF2153;")	//④
		chr_equip_chr( 43,12, "charbase0", 100,	0,0,0,		0, 0,0);
		F_set_chr( 43, CF_NO_CSP)
		F_set_chr( 12, CF_NO_MINIMAP)

		set_chr(143,811,	 5, 4,   750,-100,  0,		  0,     0, 8,"M2!12 <EV_ActiveteMimic12>;")
		chr_equip_chr(143,12, "charbase0", 100,	0,0,0,		0,0,0);
		color(143,-1);
	}
	else
	{
		set_chr(143,811,	 5, 4,   750,-100,  0,		  0,     0, 0,";")
	}


//■宝箱
	if(IT_TAKARA<0)
		set_chr( TAKARA_CH,560,	    4, 5,  -300,   0,  0,		  6,   270,20,"<EV_GetKinka>;")		//①宝箱（K）
	else
		set_chr( TAKARA_CH,560,	    4, 5,  -300,   0,  0,		  7,   270, 0,";")		//①宝箱（K）


	if ( !Fx_241Food1 )
		set_chr( WOODBOX_CH,562,	7, 3,   300,   0,  0,		  6,    90,20,"<TK_WOODBOX><EV_SetGetFood1>;")	//②木箱
	else
		set_chr( WOODBOX_CH,562,	7, 3,   300,   0,  0,		  7,    90, 0,";")	//②木箱


//■F．障害物
	set_chr( 65,991,	 3, 4,     0,   0,  0,		  0,020101, 0,";")	//①H
	if ( !F2120 )
		set_chr( 66,630,	 3, 4,     0,   0,  0,		  2,   240, 0,"I_$$$2 D0_65 SF2120;")	//①樽 (浮)
	else
		set_chr( 66,630,	 3, 4,     0,   0,  0,		  2,   240, 0,"I_$$$1 D0_65;")	//①樽 (浮)
//	chr_equip_chr( 66, 65,"TG1", 100,	0,0,180,	0,0,0);
	EV("EV_FloatingBarrel")



//■
	set_chr(  1,134,	 8, 4,   450,   0,500,		  0,   270, 0,";")	//①a いわがえる
	set_chr(  2,134,	 9, 4,  -450,   0,500,		  0,    90, 0,";")	//①b いわがえる
	set_chr(  3,168,	 8, 4,  -250, 150,  0,		 -1,   270, 8,"F100 WT?15 V2_99;")	//①c そ`どふぃっしゅ
	set_chr(  4,168,	 8, 4,   350,  50,  0,		 -1,   270, 8,"F100 WT?35 V2_99;")	//①d そ`どふぃっしゅ
	set_chr(  5,217,	 9, 4,  -300,   0,400,		 -1,   135, 8,"F100 WT?10 V2_99;")	//①e あくあ
	set_chr(  6,217,	 9, 4,  -700,  50,400,		 -1,    90, 8,"F100 WT?30 V2_99;")	//①f あくあ
	set_chr(  7,217,	 9, 4,  -900, 100,400,		 -1,    90, 8,"F100 WT?70 V2_99;")	//①g あくあ

	set_chr( 13,217,	 5, 4,   300,-100,  0,		 -1,   270, 8,"F101 WT?10 V2_99;")	//③a あくあ
	set_chr( 14,217,	 5, 4,   500,-200,  0,		 -1,   270, 8,"F101 WT?30 V2_99;")	//③d あくあ
	set_chr( 15,217,	 5, 4,   500,   0,  0,		 -1,   270, 8,"F101 WT?50 V2_99;")	//③e あくあ
	set_chr( 16,217,	 5, 4,   100,-200,  0,		 -1,   270, 8,"F101 WT?70 V2_99;")	//③b あくあ

	set_chr( 18,129,	 4, 4,   250,   0,  0,		  0,   270, 0,";")	//④ わ`しゃ`く

	set_chr( 21,211,	 2, 4,   450,   0,  0,		  0,   270, 0,";")	//⑤a しびれまんた
	set_chr( 22,211,	 3, 4,  -450,   0,  0,		  0,    90, 0,";")	//⑤b しびれまんた
	set_chr( 23,168,	 2, 4,  -250, 150,  0,		 -1,   270, 8,"F102 WT?5 V2_99;")	//⑤c そ`どふぃっしゅ
	set_chr( 24,168,	 3, 4,   250,  50,  0,		 -1,    90, 8,"F102 WT?15 V2_99;")	//⑤d そ`どふぃっしゅ
	set_chr( 25,127,	 2, 4,   600, 100,  0,		 -1,   270, 8,"F102 WT?40 V2_99;")	//⑤e がにめで
	set_chr( 26,127,	 3, 4,  -600, 150,  0,		 -1,    90, 8,"F102 WT?80 V2_99;")	//⑤f がにめで

//■イベント
	set_chr( 80,990,	 8, 4,   900, 150,  0,		  0,  0608, 6,"#8_99 SF100 M5_50 M5_51 F3 F4 F5 F6 F7 O1_18 M4_51 M4_50;")//①偿ē辚
	set_chr( 81,990,	 5, 4,   900,-150,  0,		  0,  0608, 6,"#8_99 SF101 M5_52 M5_53 F13 F14 F15 F16 O1_18 M4_53 M4_52;")//③偿ē辚
	set_chr( 82,990,	 2, 4,   900, 150,  0,		  0,  0608, 6,"#8_99 SF102 M5_54 M5_55 F23 F24 F25 F26 O1_18 M4_55 M4_54;")//⑤偿ē辚

//■雒婀逃性O定
	map_color(100,100,100,0);//R,G,B, time 100%
	map_spotbmp(25);//100%
}

//--------------------------------------------------------------------
EV_FloatingBarrel
{
	if ( !F66 )
	{
#BARREL1	66
		jump( BARREL1, 2, 8, 0,0,3,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 24, 0,0,22,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 8, 0,0,3,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 8, 0,0,-3,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 24, 0,0,-22,  0)
		wait_move( BARREL1 )
		jump( BARREL1, 2, 8, 0,0,-3,  0)
		wait_move( BARREL1 )

		loop
	}
}

//--------------------------------------------------------------------
EV_ActiveteMimic11
{
	F_reset_chr( 11, CF_NO_MINIMAP)
}

//--------------------------------------------------------------------
EV_Show142
{
	color(142,15);
	jump(142,3, 25,-1,-1, 0, 75)
}

//--------------------------------------------------------------------
EV_ActiveteMimic12
{
	F_reset_chr( 12, CF_NO_MINIMAP)
}

//--------------------------------------------------------------------
EV_Show143
{
	color(143,15);
	jump(143,3, 25,-1,-1, 0, 75)
}


//このイベントは宝箱の位置と合わせて
//座摔蛘{整する必要アリ。
//──────────────────────────────
//幸\の金入手イベント
//　　※神殿サブル`トで、幸\の金が入手できる。
//　　　そのタイミングでイベントを啡毪工搿
//──────────────────────────────
EV_GetKinka
{
//イベント_始
	
//　　通常通り、アイテム入手メッセ`ジを表示。
	TK_begin()
	rot_chr(PLAYER,60,49)

//	MES(this,"『幸\の金』を入手した。",0)
	MOT(49,1,0)
	wait(30)
	fade_in(30,10,BLACK)

	get_item(139,1,0)
	wait(10)
	wait_key(0)
	
	fade_in(0,10,BLACK)
	menu(1,		-1,	-1,-1,-1,	-1,-1,	10,0,0)
	menu(0,		-1,	-1,-1,-1,	-1,-1,	10,0,0)

	TK_end()


//　　クロスフェ`ドでラグナ．アルウェンを宝箱の前に再配置。
	cross_fade(30)
	EV_begin()
	

	//カメラセット
	CAM_move(7349,-9338,-19,20,0)
	CAM(390,100,-19,20,225,0,0)	
	
	//キャラセット
	chr_pos(RAGNA,7518,9350,0,60,2)
	chr_pos(PARTNER,7518,9623,0,,120,2)
	

	MES(RAGNA,"へえ、こいつは……\n古代の金みたいだな。",0)
	MES(RAGNA,"そういや古い金を持ってると\n幸\がやってくるって言うが……",0)
	MES_close(RAGNA)

//	name2(PARTNER)
	rot_chr(PARTNER,60,RAGNA)
	MES(PARTNER,"ふむ、あながち\n嘘ではないかもしれんぞ。",0)
	MES_close(PARTNER)

//　　ラグナに？エモ`ション。
	EMO(RAGNA,EMO_HATENA)
	wait(30)

	rot_chr(RAGNA,60,PARTNER)
	
	MES(PARTNER,"人の子の言い护à胜嗓\n知らぬが……",0)
	MES(PARTNER,"この金は、それなりの\n魔力を秘めておるようだ。",0)
	MES(PARTNER,"れば}刻まで入っておるし、\nこれだけの品であれば、持ち主に\n幸\をもたらす程度の事はできよう。",0)
	MES_close(PARTNER)

//	name2(RAGNA)
	MES(RAGNA,"へ、へえ、成る程な。",0)
	MES(RAGNA,"ちょっとした\n魔法の品ってワケか。",0)
	MES_close(RAGNA)

	//──────────────────────────────
	//	name("□クレ`ス．フラグ③をている龊稀")
	if(FE_03_TalkCleese)
	{
	//　　ラグナにＰＡエモ`ション。
		EMO(RAGNA,EMO_PA)
		wait(30)
	//　　ラグナ、宝箱の方に向きをす。
		rot_chr(RAGNA,60,49)
		
		MES(RAGNA,"ん？　そういや……",0)
		MES(RAGNA,"lかがお守りの金を\noくしたとか言ってたよな……",0)
		MES(RAGNA,"う`ん、lだったかな。",0)
		MES_close(RAGNA)
	}
	//	name("□ていない龊")
	else
	{
	//　　ラグナ、宝箱の方に向きをす。
		rot_chr(RAGNA,60,49)
		MES(RAGNA,"（あれ、でもこいつ……\n  Y丁に手入れしてあるな。）",0)
		MES(RAGNA,"（つい最近まで使ってたみたいだし……\n  lかの落し物か何かか……？）",0)
		MES_close(RAGNA)
	}
	//──────────────────────────────
	
//　　クロスフェ`ドで元の座摔ら操作S可をす。
	cross_fade(30)
	//カメラを初期O定に
	CAM_return( 30 )
	wait(30)
	EV_end()
}

//--------------------------------------------------------------------
EV_SetGetFood1
{
	F_set(Fx_241Food1)
}

#EndScriptTable
//====================================================================

