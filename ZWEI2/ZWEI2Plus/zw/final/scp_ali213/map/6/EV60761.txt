//====================================================================
//ステ`ジトラップスクリプト
//[16076][山－入口(夜)]
//====================================================================

#ScriptTable

#PARTNER	255
#PET 		254
#RAGNA 		0

#PLAYER		252	//操作キャラクタ`
#PLAYER2 	253	//非操作キャラクタ`

#MONTBLANC	2
#EVENT_RAGNA	3
#SUBARU			4
#DUMMY			5
#ALWEN			6
#POCKLE			7
#PIPIRO			8

#SPIRIT_A	10
#SPIRIT_B	11
#SPIRIT_C	12

#KAPPA		15

#ZIZOU_1	20
#ZIZOU_2	21
#ZIZOU_3	22
#ZIZOU_4	23

//--------------------------------------------------------------------
INIT
{
//h境SE
	SE(51,0)

//  -------  no typ   	  tip      x    y   z       mot     向 状  000+++++++010+++++++020+++++++030+++++++040+++++++050+++++++060+++++++070+++++++080+++++++090+++++++100+++++++110+++++++120+++++++130+++++++140+++++++150+++++++160+++++++170+++++++180+++++++190+++++++200+++++++210+++++++220+++++++230+++++++240+++++++250++
map_color(68,68,98,0);//R,G,B, time 100%

//■A段・扉

	set_chr( 90,990,	-1,-1,   -450,3000,-300,   	180,  1201, 6,"K9_10001;")	//①エントリ フィ`ルド

//	set_chr( 91,990,	-1,-1,   -100,-1330,0,  	330,050202, 6,"K0_16010;")	//①エントリ 入口分岐
	set_chr( 92,991,	-1,-1,   3344,-3040,337, 	 38,  1001, 6,"<EV_STOP_01>")	//①エントリ 坂上m当


	//地i
	//	 	管理no/typ		tip座	 +座		  mot 向き 状B  EasyScript
	//地i
	if( F4_04_OpenRoad )	//_いた後	//ＧＦ『★Lれ里へ之道を_いた』
	{
		set_chr(ZIZOU_1, 651, -1,-1, -286,-796,1,  0, 0,    3,"") 
		set_chr(ZIZOU_2, 651, -1,-1, -115,-911,1,  0,  0,    3,"") 
		set_chr(ZIZOU_3, 651, -1,-1,  224,-1139,1,  0,0,    3,"") 
		set_chr(ZIZOU_4, 651, -1,-1,  412,-1247,1,  0, 0,    3,"") 
	}
	else 					//_く前
	{	//地i
		set_chr(ZIZOU_1, 651, -1,-1, -286,-796,1,  0, 90,    3,"") 
		set_chr(ZIZOU_2, 651, -1,-1, -115,-911,1,  0,  0,    3,"") 
		set_chr(ZIZOU_3, 651, -1,-1,  224,-1139,1,  0,270,    3,"") 
		set_chr(ZIZOU_4, 651, -1,-1,  412,-1247,1,  0, 90,    3,"") 
	}
	F_set_chr(ZIZOU_1, CF_NO_CLIP)
	F_set_chr(ZIZOU_2, CF_NO_CLIP)
	F_set_chr(ZIZOU_3, CF_NO_CLIP)
	F_set_chr(ZIZOU_4, CF_NO_CLIP)
	F_set_chr(ZIZOU_1, CF_NO_CLIP2)
	F_set_chr(ZIZOU_2, CF_NO_CLIP2)
	F_set_chr(ZIZOU_3, CF_NO_CLIP2)
	F_set_chr(ZIZOU_4, CF_NO_CLIP2)


//■イベント

//■场面固有O定
	if( F4_04_OpenRoad )
	{
		mot_obj("rockgate", "open0")		//扉_く
	}

	EV("EV_SnowFall")
}

//-------------------------------------------------------------------
EV_SnowFall
{
	EFF_chr(4292, 0, 0,100, -1, "charbase0" )
	wait( 50 )
	loop
}

//====================================================================
//=== イベントI理 ===================================================
//====================================================================
//──────────────────────────────

//　　山道を登ろうとすると滑って落ちてしまう。
EV_STOP_01
{

	TK_begin()

//	if( F4_09_GoShrineMia )
	//{
	move(PLAYER,0,RUN2,2644,-1934,0,200)
	//move(PLAYER2,0,RUN2,2644,-1934,0,50)
	move(PLAYER2,0,RUN2,2632,-1874,0,50)
	wait_move(PLAYER)
	wait_move(PLAYER2)

	if( !F_RAGNA )
	{
		if(GW_MAN==1)
		{
		//　　※拉古那先^之场合
			MES(RAGNA,"呼……",0)
			MES(RAGNA,"这里\n不是玩的地方。",0)
			MES(RAGNA,"要尽快赶往城里。",0)
			MES_close(RAGNA)
		}
		else
		{
		//　　※艾雯先^之场合
			MES(PARTNER,"唔唔……好滑……",0)
			MES(PARTNER,"不能在这里\n耽搁时间。",0)
			MES(PARTNER,"要尽快赶往我的蒙布利亚。",0)
			MES_close(PARTNER)
		}
		F_set(RAGNA)
	}
	//}

	TK_end()
}
//---------------------------------------------------------------------
//地iスイッチ
//全て之地i之^を元之角度（正面）にすれば、扉が_く
//攻略法
//初期角度 0,270,270,180之状Bから①を１回、②を２回、４を１回　でＯＫ。ただ之加算な之で回す番はvSなし
//
EV_ZIZOU_CHECK
{
	if(WK001==0 && WK002==0 && WK003==0 && WK004==0)
	{
		EV("EV_4_06_OpenRoad")	//扉_くイベント_始
		wait_EV("EV_4_06_OpenRoad")
	}
}
//---------------------------------------------------------------------
//--- 地i1 -----------------------------------------------------------
//地i1を回すと、地i3、地i4も回る
EV_ZIZOU_1
{
	TK_begin()
	EV("EV_ZIZOU_1b")
	EV("EV_ZIZOU_3b")
	EV("EV_ZIZOU_4b")	
	wait_EV("EV_ZIZOU_1b")
	wait_EV("EV_ZIZOU_3b")
	wait_EV("EV_ZIZOU_4b")
	
	//地i向きチェック
	EV("EV_ZIZOU_CHECK")
	wait_EV("EV_ZIZOU_CHECK")

	TK_end()
}
//---------------------------------------------------------------------
//--- 地i2 -----------------------------------------------------------
//地i2を回すと、地i1、地i3も回る
EV_ZIZOU_2
{
	TK_begin()
	EV("EV_ZIZOU_1b")
	EV("EV_ZIZOU_2b")
	EV("EV_ZIZOU_3b")	
	wait_EV("EV_ZIZOU_1b")
	wait_EV("EV_ZIZOU_2b")
	wait_EV("EV_ZIZOU_3b")
	
	//地i向きチェック
	EV("EV_ZIZOU_CHECK")
	wait_EV("EV_ZIZOU_CHECK")
	TK_end()
}
//---------------------------------------------------------------------
//--- 地i3 -----------------------------------------------------------
//地i2を回すと、地i3、地i4も回る
EV_ZIZOU_3
{
	TK_begin()
	EV("EV_ZIZOU_2b")
	EV("EV_ZIZOU_3b")
	EV("EV_ZIZOU_4b")	
	wait_EV("EV_ZIZOU_2b")
	wait_EV("EV_ZIZOU_3b")
	wait_EV("EV_ZIZOU_4b")	
	
	//地i向きチェック
	EV("EV_ZIZOU_CHECK")
	wait_EV("EV_ZIZOU_CHECK")

	TK_end()
}
//---------------------------------------------------------------------
//--- 地i4 -----------------------------------------------------------
//地i4を回すと、地i1、地i2も回る
EV_ZIZOU_4
{
	TK_begin()
	EV("EV_ZIZOU_1b")
	EV("EV_ZIZOU_2b")
	EV("EV_ZIZOU_4b")	
	wait_EV("EV_ZIZOU_1b")
	wait_EV("EV_ZIZOU_2b")
	wait_EV("EV_ZIZOU_4b")	
	
	//地i向きチェック
	EV("EV_ZIZOU_CHECK")
	wait_EV("EV_ZIZOU_CHECK")

	TK_end()
}

//地i１回
EV_ZIZOU_1b
{
	if(WK001==0)
	{
		rot(ZIZOU_1, 30, 270)
		workL(1,SET,27)		
	
//		MES(ZIZOU_1,"角度270",0)
	}
	else
	if(WK001==9)
	{
		rot(ZIZOU_1, 30, 0)
		workL(1,SET,0)
			
//		MES(ZIZOU_1,"角度000",0)
	}
	else
	if(WK001==18)
	{
		rot(ZIZOU_1, 30, 90)
		workL(1,SET,9)	
		
//		MES(ZIZOU_1,"角度090",0)
	}
	else
	if(WK001==27)
	{
		rot(ZIZOU_1, 30, 180)
		workL(1,SET,18)
//		MES(ZIZOU_1,"角度180",0)

	}
	else
	{
		MES(ZIZOU_1,"角度？",0)
	}
	MES_close(ZIZOU_1)	
	
	wait(30)
}

//地i２回
EV_ZIZOU_2b
{
	EMO(ZIZOU_2, EMO_BIKKURI)
	if(WK002==0)
	{
		rot(ZIZOU_2, 30, 270)
		workL(2,SET,27)	
	}
	else
	if(WK002==9)
	{
		rot(ZIZOU_2, 30, 360)
		workL(2,SET,0)
	}
	else
	if(WK002==18)
	{
		rot(ZIZOU_2, 30, 90)
		workL(2,SET,9)
	}
	else
	if(WK002==27)
	{
		rot(ZIZOU_2, 30, 180)
		workL(2,SET,18)
	}
	else
	{
		MES(ZIZOU_2,"角度？",0)

	}
	MES_close(ZIZOU_2)		
	wait(30)
}

//地i３回
EV_ZIZOU_3b
{
	EMO(ZIZOU_3, EMO_BIKKURI)
	if(WK003==0)
	{
		rot(ZIZOU_3, 30, 270)
		workL(3,SET,27)	
	}
	else
	if(WK003==9)
	{
		rot(ZIZOU_3, 30, 0)
		workL(3,SET,0)
	}
	else
	if(WK003==18)
	{
		rot(ZIZOU_3, 30, 90)
		workL(3,SET,9)	
	}
	else
	if(WK003==27)
	{
		rot(ZIZOU_3, 30, 180)
		workL(3,SET,18)
	}
	else
	{
		MES(ZIZOU_3,"角度？",0)
		MES_close(ZIZOU_3)	
	}
	wait(30)
}

//地i４回
EV_ZIZOU_4b
{
	if(WK004==0)
	{
		rot(ZIZOU_4, 30, 270)
		workL(4,SET,27)	
	}
	else
	if(WK004==9)
	{
		rot(ZIZOU_4, 30, 0)
		workL(4,SET,0)
	}
	else
	if(WK004==18)
	{
		rot(ZIZOU_4, 30, 90)
		workL(4,SET,9)	
	}
	else
	if(WK004==27)
	{
		rot(ZIZOU_4, 30, 180)
		workL(4,SET,18)
	}
	else
	{
		MES(ZIZOU_4,"角度？",0)
		MES_close(ZIZOU_4)	
	}
	wait(30)
}

#EndScriptTable
//====================================================================

